# Smart Video Background Replacement
Этот скрипт предназначен для автоматической обработки видеофайлов, включая удаление фона из каждого кадра и замену его изображением или цветом. Обработка может выполняться с использованием графического процессора (GPU), если он доступен, или с использованием центрального процессора (CPU). Он использует библиотеку rembg для удаления фона, cv2 для обработки кадров, PIL для обработки изображений и moviepy для обработки аудио и видео.
![Замена фрна на видео](image%20(18).jpg)
## Функциональность:

Удаление фона: каждый видеокадр имеет свой фон, удаленный с помощью библиотеки rembg. Фон может быть заменен предопределенным изображением или сплошным цветом.

Обработка на GPU или CPU: Если доступен GPU, обработка происходит на GPU, что ускоряет процесс. В противном случае для обработки используется CPU.

Обработка видео: Видео извлекается и разбивается на кадры. После удаления фона каждый кадр сохраняется как отдельный файл. Затем кадры собираются в финальное видео.

Интеграция звука: после обработки видео исходный звук из входного видео добавляется обратно к выходному видео.

Многопоточность: видео обрабатываются одновременно с помощью ThreadPoolExecutor для эффективной обработки нескольких видео.

## Установка
Чтобы установить зависимости проекта, выполните следующие действия:

Убедитесь, что у вас установлен Python версии 3.10. Проект был протестирован только на этой версии.
### Создайте и активируйте виртуальную среду:
 
  
#### Для Windows:
`  python -m venv venv`

`.\venv\Scripts\activate`
  
#### Для macOS/Linux:
`python -m venv venv`

`source venv/bin/activate`
#### # Update pip to the latest version:

`python -m pip install --upgrade pip`

#### # Install dependencies with the following command:

`pip install -r requirements.txt -f https://download.pytorch.org/whl/cu121/torch_stable.html`

This command will install all the libraries required to run the project, including PyTorch with CUDA support.

------------------------------------------------------------------------------------------------------------------

### Изменение цвета фона

В этом проекте цвет фона по умолчанию установлен как зелёный (RGBA) для обработки видео. Чтобы изменить цвет фона, вы можете сделать следующее:

1. По умолчанию - зелёный цвет: зелёный цвет установлен как (0, 255, 0, 255). Это означает, что фон будет зелёным с полной непрозрачностью.

2. Установка прозрачного фона: чтобы использовать прозрачный фон, измените переменную background_color на (0, 0, 0, 0). Это создаст полностью прозрачный фон. Вам нужно убедиться, что у вас есть альфа-канал цвета для работы с прозрачностью в изображении. 
background_color = (0, 0, 0, 0) # Прозрачный фон (RGBA).

Использование пользовательского изображения в качестве фона: если вы хотите заменить фон изображением, просто укажите путь к вашему изображению в переменной `background_image_path`. 
Если файл существует, он будет загружен и использован как фон.
`background_image_path = 'path/to/your/background_image.jpg'` # Путь к изображению фона.

### Пример изменения переменных в коде: 
#### # Зелёный фон по умолчанию 
`background_color = (0, 255, 0, 255)` # Зелёный цвет фона 
#### # Для прозрачного фона 
`background_color = (0, 0, 0, 0)` # Прозрачный фон 
#### # Для пользовательского изображения фона 
`background_image_path = 'image.jpg'` # Замените на путь к вашему изображению
